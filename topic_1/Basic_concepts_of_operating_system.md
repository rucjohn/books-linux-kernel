## 操作系统基本概念

任何计算机系统都包含一个名为操作系统的基本程序集合。在这个集合里，最重要的程序称为内核（*kernel*）。当操作系统启动时，内核被装入到 RAM 中，内核中包含了操作系统运行所必不可少的很多核心过程（*procedure*）。其他程序是一些不太重要的实用程序，尽管这些程序为用户提供了与计算机进行广泛交互的体验（以及用户买计算机要做的所有工作），但系统根本的样子和能力还是由内核决定。内核也为系统中所有事情提供了主要功能，并决定高层软件的很多特性。因此，我们将经常使用术语 “操作系统” 作为 “内核” 的同义词。

操作系统必须完成两个主要目标：
- 与硬件部分交互，为包含在硬件平台上的所有低层可编程部件提供服务。
- 为运行在计算机系统上的应用程序（即所谓用户程序）提供执行环境。

一些操作系统允许所有的用户程序都直接与硬件部分进行交互（典型的例子是 MS-DOS）。与此相反，类 Unix 操作系统把与计算机物理组织相关的所有低层细节都对用户运行的程序隐藏起来。当程序想使用硬件资源时，必须向操作系统发出一个请求。内核对这个请求进行评估，如果允许使用这个资源，那么，内核代表应用程序与相关的硬件部分进行交互。

为了实施这种机制，现代操作系统依靠特殊的硬件特性来禁止用户程序直接与低层硬件部分进行交互，或者禁止直接访问任意的物理地址。特别是，硬件为 CPU 引入了至少两种不同的执行模式：用户程序的非特权模式和内核的特权模式。Unix 把它们分别称为用户态（*User Mode*）和内核态（*Kernel Model*）。

我们将在本章剩余部分介绍一些基本概念，在过去 20 多年里，这些概念推动了 Unix、Linux 和其他操作系统的设计。作为 Linux 用户，你也许已熟悉了这些概念，但为了说明这些概念对 Linux 内核的必要性，下面试图对其作更深一步的研究。这些广泛的考虑事实上涉及到全部类 Unix 系统。希望本书的其他章节能帮助你理解 Linux 内核内幕。

### 多用户系统

多用户系统（*multiuse system*）就是一台能并发和独立地执行分别属于两个和多个用户的若干应用程序的计算机。“并发”（*concurrently*）意味着几个应用程序能同时处于活动状态并竞争各种资源，如 CPU、内存、硬盘等等。“独立”（*independently*）意味着每个应用程序能执行自己的任务，而无需考虑其他用户的应用程序在干些什么。当然，从一个应用程序切换到另一个会使每个应用程序的速度有所减慢，从而影响用户看到的响应时间。现代操作系统内核提供的许多复杂特性（我们将在本书中考察这些特性）减少了强加在每个程序上的延迟时间，给用户提供了尽可能快的响应时间。

多用户操作系统必须包含以下几个特点：
- 核实用户身份的认证机制。
- 防止有错误的用户程序妨碍其他应用程序在系统中运行的保护机制。
- 防止有恶意的用户程序干涉或窥视其他用户的活动的保护机制。
- 限制分配给每个用户的资源数的记账机制。

为了确保能实现这些安全机制，操作系统必须利用与 CPU 特权模式相关的硬件保护机制，否则，用户程序将能直接访问系统电路并克服强加于它的这些限制。Unix 是实施系统资源硬件保护的多用户系统。

### 用户和组

在多用户系统中，每个用户在机器上都有私用空间；典型地，他拥有一定数量的磁盘空间来存储文件、接收私人邮件信息等等。操作系统必须保证用户空间的私有部分仅仅对其拥有者是可见的。特别是必须能保证，没有用户能够开发一个用于侵犯其他用户私有空间的系统应用程序。

所有的用户由一个唯一的数字来标识，这个数字叫用户标识符（*User ID, UID*）。通常一个计算机系统只能由有限的人使用。当其中的某个用户开始一个工作会话时，操作系统要求输入一个登录名和口令，如果用户输入的信息无效，则系统拒绝访问。因为口令是不公开的，所以用户的保密性得到了保证。

为了和其他用户有选择地共享资料，每个用户是一个或多个用户组的一名成员，组由唯一的用户组标识符（*user group ID, GID*）标识。每个文件也恰好与一个组相对应。例如，可以设置这样的访问权限，拥有文件的用户具有对文件的读写权限，同组用户仅有只读权限，而系统中的其他用户没有对文件的任何访问权限。

任何类 Unix 操作系统都有一个特殊的用户，叫做 *root*，即超级用户（*superuser*）。系统管理员必须以 root 的身份登录，以便处理用户账号，完成诸如系统备份、程序升级等维护任务。root 用户几乎无所不能，因为操作系统对她不使用通常的保护机制。尤其是，root 用户能访问系统中每个文件，能干涉每一个正在执行的用户程序的活动。

### 进程

### 内核体系结构


